(()=>{"use strict";var t,e={860:()=>{const t=window.wp.blocks,e=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"patrons-tips/patron-history","version":"1.0.2","category":"patrons-tips","icon":"backup","title":"Patron history","description":"Show the list of patronage tier(s) subscribed per period.","keywords":["patronage","history","level","old","past","previous","list","summary","orders","record","archive","timeline","periods","monthly"],"example":{},"supports":{"html":false},"attributes":{"userID":{"type":"integer","default":0},"patronID":{"type":"integer","default":0},"tiers":{"type":"array","default":[]},"period":{"type":"string","default":""},"date":{"type":"string","default":""},"current":{"type":"boolean","default":false},"active":{"type":"boolean","default":true},"columns":{"type":"array","default":["period","end","tier","price","actions"]},"perPage":{"type":"integer","default":12}},"textdomain":"patrons-tips","editorScript":"file:index.js","editorStyle":"file:index.css","style":"file:style-index.css","script":["patips-js-global-variables","patips-js-global-functions"]}'),r=window.wp.i18n,s=window.wp.blockEditor,a=window.wp.element,i=window.wp.components,n=window.ReactJSXRuntime;function o(t){var e,o;const p=null!==(e=patips_var?.tiers)&&void 0!==e?e:{},l=null!==(o=patips_var?.patron_history_columns)&&void 0!==o?o:{},[c,d]=(0,a.useState)((()=>(()=>{let e=[];return t.attributes.columns.forEach((t=>{var r;let s=null!==(r=l?.[t])&&void 0!==r?r:t;e.push(s)})),e})()));return(0,a.useEffect)((()=>{t.setAttributes({columns:c.map((t=>{return e=t,null!=(r=Object.keys(l).find((t=>l?.[t]===e)))?r:e;var e,r}))})}),[c]),(0,n.jsxs)(s.InspectorControls,{children:[(0,n.jsxs)(i.PanelBody,{title:(0,r.__)("Filters","patrons-tips"),children:[(0,n.jsx)(i.SelectControl,{multiple:!0,label:(0,r.__)("Tiers","patrons-tips"),value:t.attributes.tiers,options:(()=>{let t=[];return p&&Object.keys(p).map((e=>{var s;let a=p[e];t.push({value:a.id,
/* translators: %s is the tier ID */
label:null!==(s=a?.title)&&void 0!==s?s:(0,r.sprintf)((0,r.__)("Tier #%s","patrons-tips"),a.id)})})),t})(),onChange:e=>t.setAttributes({tiers:e.map((t=>parseInt(t)))})}),(0,n.jsx)(i.TextControl,{type:"number",label:(0,r.__)("Per page","patrons-tips"),value:t.attributes.perPage,onChange:e=>t.setAttributes({perPage:parseInt(e)})})]}),(0,n.jsx)(i.PanelBody,{title:(0,r.__)("Display","patrons-tips"),children:(0,n.jsx)(i.FormTokenField,{label:(0,r.__)("Columns","patrons-tips"),value:c,suggestions:(()=>{let t=[];return Object.keys(l).forEach((e=>{t.push(l[e])})),t})(),onChange:t=>{d(t)},__experimentalShowHowTo:!0,__experimentalExpandOnFocus:!0})})]})}const p={from:[{type:"shortcode",tag:["patronstips_patron_history"],isMatch:t=>!0,transform(e,r){var s,a;return(0,t.createBlock)("patrons-tips/patron-history",{userID:void 0!==e?.named?.user_id?parseInt(e?.named?.user_id):0,patronID:void 0!==e?.named?.patron_id?parseInt(e?.named?.patron_id):0,tiers:void 0!==e?.named?.tier_ids?e.named.tier_ids.split(",").map((t=>parseInt(t))):[],period:null!==(s=e?.named?.period)&&void 0!==s?s:"",date:null!==(a=e?.named?.date)&&void 0!==a?a:"",current:void 0!==e?.named?.current&&parseInt(e.named.current),active:void 0!==e?.named?.active&&parseInt(e.named.active),perPage:void 0!==e?.named?.per_page?parseInt(e.named.per_page):12,columns:void 0!==e?.named?.columns?e.named.columns.split(",").map((t=>t.trim())):[]})}}]};(0,t.registerBlockType)(e,{edit:function(t){const e=(0,s.useBlockProps)(),i=t.attributes.columns.length?t.attributes.columns:["period","end","tier","price","actions"],p=(()=>{let t={};return void 0!==patips_var?.tiers&&Object.keys(patips_var.tiers).length&&(t=patips_var.tiers),Object.keys(t).length||(t={
/* translators: %s is the tier ID */
1:{id:1,title:(0,r.sprintf)((0,r.__)("Tier #%s","patrons-tips"),1),price:10},
/* translators: %s is the tier ID */
2:{id:2,title:(0,r.sprintf)((0,r.__)("Tier #%s","patrons-tips"),2),price:20},
/* translators: %s is the tier ID */
3:{id:3,title:(0,r.sprintf)((0,r.__)("Tier #%s","patrons-tips"),3),price:30}}),t})(),l=(t,e,r)=>{let s=new Date(t,e,r||1),a=void 0!==patips_var?.locale?patips_var.locale.replace("_","-"):"en-US";return s.toLocaleString(a,r?{day:"numeric",month:"long",year:"numeric"}:{month:"long",year:"numeric"})},c=(()=>{let e=[],s=Math.min(t.attributes.perPage,3),a=new Date;a.setDate(1);let i=t.attributes.tiers.length?t.attributes.tiers:Object.keys(p);for(let t=0;t<s;t++){var n,o,c;let t=new Date(a.getFullYear(),a.getMonth(),1),s=new Date(a.getFullYear(),a.getMonth()+1,0),d=i[Math.floor(Math.random()*i.length)],u=null!==(n=p?.[d])&&void 0!==n?n:{},m=Math.floor(9999*Math.random()+1),h=Math.floor(999*Math.random()+1),v=Math.random()>.1?'<a href="#" className="woocommerce-button button view">'+(0,r.sprintf)((0,r.__)("View order #%s","patrons-tips"),m)+"</a>":"";
/* translators: %s = subscription ID */
v+=""!==v&&Math.random()>.3?'<a href="#" className="woocommerce-button button view">'+(0,r.sprintf)((0,r.__)("View subscription #%s","patrons-tips"),h)+"</a>":"",e.push({period:l(a.getFullYear(),a.getMonth(),0),start:l(t.getFullYear(),t.getMonth(),t.getDate()),end:l(s.getFullYear(),s.getMonth(),s.getDate()),
/* translators: %s is the tier ID */
tier:null!==(o=u?.title)&&void 0!==o?o:(0,r.sprintf)((0,r.__)("Tier #%s","patrons-tips"),1),price:patips_format_price(null!==(c=u?.price)&&void 0!==c?c:10,{plain_text:!0}),actions:v}),a.setMonth(a.getMonth()-1)}return e})();return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)(o,{attributes:{tiers:t.attributes.tiers,period:t.attributes.period,current:t.attributes.current,active:t.attributes.active,perPage:t.attributes.perPage,columns:t.attributes.columns},setAttributes:t.setAttributes}),(0,n.jsx)("div",{...e,children:(0,n.jsx)("div",{className:"patips-patron-history-block"+(t.isSelected?" patips-selected-block":""),children:(0,n.jsxs)("div",{className:"patips-ajax-list patips-patron-history-list",children:[(0,n.jsxs)("table",{className:"patips-responsive-table",children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:i.map((t=>{let e=patips_var?.patron_history_columns?.[t]?patips_var?.patron_history_columns?.[t]:t;return(0,n.jsx)("th",{className:"patips-patron-history-list-column-"+t,children:e},t)}))})}),(0,n.jsx)("tbody",{className:"patips-ajax-list-items patips-patron-history-list-items",children:Object.keys(c).map((t=>{let e=c[t];return(0,n.jsx)("tr",{children:i.map((r=>{var s;let i=patips_var?.patron_history_columns?.[r]?patips_var?.patron_history_columns?.[r]:r;return(0,n.jsx)("td",{"data-title":i,className:"patips-patron-history-list-column-"+r,children:(0,n.jsx)(a.RawHTML,{children:null!==(s=e?.[r])&&void 0!==s?s:""})},t+"_"+r)}))},t)}))})]}),t.attributes.perPage<3&&(0,n.jsx)("div",{className:"patips-ajax-list-more patips-patron-history-list-more",children:(0,n.jsx)("a",{href:"#",className:"patips-ajax-list-more-link patips-patron-history-list-more-link",children:(0,r.__)("See more","patrons-tips")})})]})})})]})},save:function(t){return null},transforms:p})}},r={};function s(t){var a=r[t];if(void 0!==a)return a.exports;var i=r[t]={exports:{}};return e[t](i,i.exports,s),i.exports}s.m=e,t=[],s.O=(e,r,a,i)=>{if(!r){var n=1/0;for(c=0;c<t.length;c++){for(var[r,a,i]=t[c],o=!0,p=0;p<r.length;p++)(!1&i||n>=i)&&Object.keys(s.O).every((t=>s.O[t](r[p])))?r.splice(p--,1):(o=!1,i<n&&(n=i));if(o){t.splice(c--,1);var l=a();void 0!==l&&(e=l)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[r,a,i]},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={295:0,943:0};s.O.j=e=>0===t[e];var e=(e,r)=>{var a,i,[n,o,p]=r,l=0;if(n.some((e=>0!==t[e]))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);if(p)var c=p(s)}for(e&&e(r);l<n.length;l++)i=n[l],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(c)},r=globalThis.webpackChunkpatips_blocks=globalThis.webpackChunkpatips_blocks||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var a=s.O(void 0,[943],(()=>s(860)));a=s.O(a)})();